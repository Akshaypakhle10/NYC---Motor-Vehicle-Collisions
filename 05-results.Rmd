# Results

```{r message=FALSE, warning=FALSE}
register_google(key = api_key)

map_m <- get_map(location = 'manhattan, new york',zoom=12, maptype = 'roadmap',source = 'google',color = 'color')
map_q <- get_map(location = 'queens, new york',zoom=11, maptype = 'roadmap',source = 'google',color = 'color')
map_bx <- get_map(location = 'bronx, new york',zoom=12, maptype = 'roadmap',source = 'google',color = 'color')
map_bl <- get_map(location = 'brooklyn, new york',zoom=11, maptype = 'roadmap',source = 'google',color = 'color')
map_s <- get_map(location = 'staten island, new york',zoom=12, maptype = 'roadmap',source = 'google',color = 'color')

data_m = subset(data, !is.na(data$LATITUDE) & !is.na(data$LONGITUDE) & data$LATITUDE!=0 & data$LONGITUDE!=0 & data$BOROUGH=="MANHATTAN")

plot_m <- ggmap(map_m) + stat_density2d(
    aes(x = data_m$LONGITUDE, y = data_m$LATITUDE, fill = ..level.., alpha = 1),
    size = 0.001, bins = 100, data = data_m,
    geom = "polygon"
  ) + scale_fill_viridis_c() +
      labs(x='Longitude',
           y='Latitude') + theme_minimal()



data_q = subset(data, !is.na(data$LATITUDE) & !is.na(data$LONGITUDE) & data$LATITUDE!=0 & data$LONGITUDE!=0 & data$BOROUGH=="QUEENS")

plot_q <- ggmap(map_q) + stat_density2d(
    aes(x = data_q$LONGITUDE, y = data_q$LATITUDE, fill = ..level.., alpha = 1),
    size = 0.001, bins = 100, data = data_q,
    geom = "polygon"
  ) + scale_fill_viridis_c()+
      labs(x='Longitude',
           y='Latitude') + theme_minimal()



data_bx = subset(data, !is.na(data$LATITUDE) & !is.na(data$LONGITUDE) & data$LATITUDE!=0 & data$LONGITUDE!=0 & data$BOROUGH=="BRONX")

plot_bx <- ggmap(map_bx) + stat_density2d(
    aes(x = data_bx$LONGITUDE, y = data_bx$LATITUDE, fill = ..level.., alpha = 1),
    size = 0.001, bins = 100, data = data_bx,
    geom = "polygon"
  ) + scale_fill_viridis_c() +
      labs(x='Longitude',
           y='Latitude') + theme_minimal()



data_bl = subset(data, !is.na(data$LATITUDE) & !is.na(data$LONGITUDE) & data$LATITUDE!=0 & data$LONGITUDE!=0 & data$BOROUGH=="BROOKLYN")

plot_bl <- ggmap(map_bl) + stat_density2d(
    aes(x = data_bl$LONGITUDE, y = data_bl$LATITUDE, fill = ..level.., alpha = 1),
    size = 0.001, bins = 100, data = data_bl,
    geom = "polygon"
  ) + scale_fill_viridis_c() +
      labs(x='Longitude',
           y='Latitude') + theme_minimal()



data_s = subset(data, !is.na(data$LATITUDE) & !is.na(data$LONGITUDE) & data$LATITUDE!=0 & data$LONGITUDE!=0 & data$BOROUGH=="STATEN ISLAND")

plot_s <- ggmap(map_s) + stat_density2d(
    aes(x = data_s$LONGITUDE, y = data_s$LATITUDE, fill = ..level.., alpha = 1),
    size = 0.001, bins = 100, data = data_s,
    geom = "polygon"
  ) + scale_fill_viridis_c() +
      labs(x='Longitude',
           y='Latitude') + theme_minimal()
```

```{r fig.keep='all', message=FALSE, warning=FALSE, results='hide', echo=FALSE}
ggarrange(plot_m, plot_q, plot_bx, plot_bl, plot_s, ncol=2, labels = c("Manhattan", "Queens", "Bronx", "Brooklyn", "Staten Island"))
```


```{r message=FALSE, warning=FALSE}
data_subset <- subset(data, !is.na(data$BOROUGH))
temp2 <- data_subset %>%
  group_by(BOROUGH)%>%
  summarize(Total = n()/1000)%>%
  mutate(BOROUGH = fct_reorder(BOROUGH, Total, .desc = TRUE))


ggplot(temp2, aes(BOROUGH,Total))+
geom_bar( stat = "identity", width = 0.4, fill = "orange", color = "black")+
  xlab("Borough")+
    ylab("Number of Accidents (In Thousands)")+
    ggtitle("Borough-wise Accidents in NY from 2012-2019")+theme_minimal()

```




I'm going to manually create a list of the areas of the five boroughs, I could scrape it using rvest, but I feel its too much of an effort for just getting five values, so I prefer manual entries in this case. Source : https://en.wikipedia.org/wiki/Boroughs_of_New_York_City

```{r message=FALSE, warning=FALSE}
#Areas in Square miles arranged according to ascending order of Borough Name, Just as in temp2.
Area = c(42.10,70.82,22.83,108.53,58.37)
temp2 <- cbind(temp2, Area)

temp2 <- temp2 %>%
            mutate(accident_density = Total/Area) %>%
            mutate(BOROUGH = fct_reorder(BOROUGH, accident_density, .desc = TRUE))

ggplot(temp2, aes(BOROUGH, accident_density))+
geom_bar( stat = "identity", width = 0.4, , fill = "orange", color = "black")+
  xlab("Borough")+
    ylab("Number of Accidents/ Area")+
    ggtitle("Borough-wise Accident Density in NY from 2012-2019")+theme_minimal()
```

And yeah, what we saw was correct. Manhattan has over twice the no. of accident-density(i.e. No. of accidents/Area of the Borough) than the next highest, which is Brooklyn.

```{r message=FALSE, warning=FALSE}
ggplot(data_subset,aes(x=YEAR,fill=BOROUGH )) +
      geom_bar( position='dodge', width=0.9, color="black") +
  scale_x_continuous(breaks = c(2012, 2013,2014,2015,2016,2017,2018,2019) ) +
  xlab("Borough")+
    ylab("Number of Accidents")+
    ggtitle("Borough-wise Accidents in NY from 2012-2019")+theme_minimal() + scale_fill_brewer(palette = "Set2")
```




```{r message=FALSE, warning=FALSE}
month_data <- data_subset %>% 
  select(MONTH, BOROUGH) %>% 
  group_by(MONTH, BOROUGH) %>% 
  summarize(total = n())

month_bw <- data_subset %>% 
  group_by(BOROUGH) %>% summarise(total = n())

new <- merge(month_data, month_bw , by="BOROUGH" , all.x = TRUE) %>% mutate(total = total.x/total.y )


ggplot(new,aes(x=MONTH,y=total,group=BOROUGH, colour = BOROUGH)) + geom_point() + geom_line() +
      labs(title='Borough-wise Monthly Proportion of Accidents',
           x='Months',
           y='Proportion of Accidents')+
  scale_x_continuous(limits = c(1, 12), breaks = 1:12,
                         labels=c("Jan","Feb","Mar","Apr","May","Jun",
                                  "Jul","Aug","Sep","Oct","Nov","Dec"))+
  scale_y_continuous(limits = c(0, 0.12), breaks=c(0, 0.02, 0.04, 0.06, 0.08, 0.1, 0.12)) +
  theme_minimal() 
```



```{r message=FALSE, warning=FALSE}
bw <- data_subset %>% select(`ACCIDENT TIME`, BOROUGH) %>% mutate(TIME = as.POSIXct(`ACCIDENT TIME`, format = "%H"))%>% mutate(TIME = strftime(TIME, format="%H")) %>% group_by(BOROUGH) %>% summarise(total = n())

time <- data_subset %>% select(`ACCIDENT TIME`, BOROUGH) %>% mutate(TIME = as.POSIXct(`ACCIDENT TIME`, format = "%H"))%>% mutate(TIME = strftime(TIME, format="%H")) %>% group_by(TIME, BOROUGH) %>% summarise(total = n())

new <- merge(time,bw , by="BOROUGH" , all.x = TRUE) %>% mutate(total = total.x/total.y )

ggplot(new,aes(x=TIME,y=total,group=BOROUGH, colour = BOROUGH)) + geom_point() + geom_line() +
      labs(title='Borough-wise Hourly Proportion of Accidents',
           x='Hour of the day',
           y='Proportion of Accidents')+
      theme_minimal()

```




```{r message=FALSE, warning=FALSE}
data %>%
  select(`NUMBER OF CYCLIST INJURED`, `NUMBER OF PEDESTRIANS INJURED`,`NUMBER OF MOTORIST INJURED`, `NUMBER OF CYCLIST KILLED`, `NUMBER OF PEDESTRIANS KILLED`, `NUMBER OF MOTORIST KILLED`) %>% 
  gather("key", "value") %>%
  mutate(`Killed / Injured` = ifelse(endsWith(key, "KILLED"), "Killed", "Injured")) %>% 
  ggplot(aes(x=key, y=value, color=`Killed / Injured`)) + geom_boxplot() +coord_flip() + theme_minimal() +
      labs(title = "Boxplot of Number of Cyclists/Pedestrians/Motorists Killed or Injured ", 
           y='Count',
           x='')
```
# car rams times sq: 5/18/17 - 27
# BUS ACCIDENT: 9/9/2013 - 43




```{r message=FALSE, warning=FALSE}
stackeddata <- data_subset %>%
  select(`NUMBER OF PEDESTRIANS INJURED`,`NUMBER OF PEDESTRIANS KILLED`, `NUMBER OF CYCLIST INJURED`, `NUMBER OF CYCLIST KILLED`, `NUMBER OF MOTORIST INJURED`,`NUMBER OF MOTORIST KILLED`,BOROUGH)
stackeddata[is.na(stackeddata)] <- 0
stackeddata<- stackeddata %>%
  group_by(BOROUGH) %>%
  summarize_each(funs(sum)) %>%
  gather(`Victim Types`,"value",-BOROUGH)

# stackeddata<- data %>% group_by("BOROUGH") %>% summarize_each(funs(sum))
ggplot(stackeddata,aes(x= stackeddata$BOROUGH,y=stackeddata$value,fill=`Victim Types`)) + 
  geom_col()+
  xlab("Borough")+
    ylab("Count")+
    ggtitle("Borough-wise Number of Victim Types")+theme_minimal() + scale_fill_brewer(palette = "Set2")
```

```{r message=FALSE, warning=FALSE}
head(arrange(stackeddata, value))
```

```{r message=FALSE, warning=FALSE}
tail(arrange(stackeddata, value))
```




```{r message=FALSE, warning=FALSE}
# No. of accidents that led to deaths.
lethal_collisions = data_subset %>%
  mutate(Deaths = `NUMBER OF PERSONS KILLED`+ `NUMBER OF CYCLIST KILLED` + `NUMBER OF PEDESTRIANS KILLED`+ `NUMBER OF MOTORIST KILLED`)%>%
  filter(Deaths > 0)%>%
  mutate(BOROUGH = fct_reorder(BOROUGH, Deaths, .desc = TRUE))

#Accidents by Borough
count_collisions_by_borough = data_subset %>%
  group_by(BOROUGH) %>%
  summarise(accidents = n())%>%
  mutate(BOROUGH = fct_reorder(BOROUGH, accidents, .desc = TRUE))

# Lethal Accidents by Borough
count_lethal_collisions_by_borough = lethal_collisions %>%
  group_by(BOROUGH) %>%
  summarise(lethal_accidents = n())%>%
  mutate(BOROUGH = fct_reorder(BOROUGH, lethal_accidents, .desc = TRUE))

how_lethal = inner_join(count_collisions_by_borough, count_lethal_collisions_by_borough, by='BOROUGH')

how_lethal$percent_lethal = how_lethal$lethal_accidents *100 / how_lethal$accidents
ggplot(how_lethal,aes(x = fct_reorder(BOROUGH,lethal_accidents,.desc = TRUE), y = lethal_accidents/1000))+
  geom_bar(stat='identity', color = "black", fill = "orange", width = 0.4)+
  xlab("Borough")+
    ylab("Proportion")+
    ggtitle("Proportion of Accidents Causing Deaths from 2012-2019")+theme_minimal()+scale_fill_brewer(palette = "Set2")
```







```{r message=FALSE, warning=FALSE}
clean_data <- data
clean_data[is.na(clean_data)] <- 0

kill_inj <- clean_data %>%
  select(YEAR,`NUMBER OF PERSONS INJURED`, `NUMBER OF PERSONS KILLED`) %>%
  group_by(YEAR) %>%  summarise_each(funs(sum)) %>%
  gather("key","value",-YEAR)

ggplot(kill_inj, aes(x=YEAR,y=value,colour=key)) + geom_line() +geom_point() +# facet_wrap(.~key, scales = "free", ncol = 1) + scale_x_continuous(breaks = c(2012:2019))+ scale_fill_brewer(palette = "Set2")+
  xlab("Year")+
    ylab("Count")+
    ggtitle("Number of People Killed/Injured in Accidents from 2012-2019")+theme_minimal()
```


```{r message=FALSE, warning=FALSE}
kill_inj <- clean_data %>%
  select(YEAR, `NUMBER OF PERSONS KILLED`) %>%
  group_by(YEAR) %>%  summarise_each(funs(sum)) %>%
  gather("key","value",-YEAR)

ggplot(kill_inj, aes(x=YEAR,y=value)) + geom_line(colour="#00C5CD") +geom_point(,colour="#00C5CD") +# facet_wrap(.~key, scales = "free", ncol = 1) + scale_x_continuous(breaks = c(2012:2019))+ scale_fill_brewer(palette = "Set2")+
  xlab("Year")+
    ylab("Count")+
    ggtitle("Number of People Injured in Accidents from 2012-2019")+theme_minimal() +
  scale_y_continuous(limits=c(0,250))
```



```{r message=FALSE, warning=FALSE}
df_cause <- data_subset %>%
  select(BOROUGH, `CONTRIBUTING FACTOR VEHICLE 1`, `CONTRIBUTING FACTOR VEHICLE 2`, `CONTRIBUTING FACTOR VEHICLE 3`, `CONTRIBUTING FACTOR VEHICLE 4`, `CONTRIBUTING FACTOR VEHICLE 5`) %>%
      gather(., key='key', value='cause',
             `CONTRIBUTING FACTOR VEHICLE 1`, `CONTRIBUTING FACTOR VEHICLE 2`, `CONTRIBUTING FACTOR VEHICLE 3`, `CONTRIBUTING FACTOR VEHICLE 4`, `CONTRIBUTING FACTOR VEHICLE 5`) %>%
      # filtering out missing and most common, general, uninformative records:
      filter(!(cause %in% c('',
                            'Unspecified',
                            'Driver Inattention/Distraction',
                            'Other Vehicular',
                            'Failure to Yield Right-of-Way')))

# find and select top 20 causes overall:
  df_cause_top <- df_cause %>%
      group_by(cause) %>%
      summarise(count=n()) %>%
      top_n(20, count)

df <- df_cause_top %>%
      filter(!is.na(cause))%>%
      mutate(cause_z = round((count - min(count))/(max(count)-min(count)), 4),
             cause_type = ifelse(cause_z < 0, 'below', 'above'))

 ggplot(data = df) +
      geom_bar(aes(x=reorder(cause, cause_z), y=cause_z),
               width=0.5, stat='identity', show.legend = F, fill="orange", color="black") +
      coord_flip() +
      labs(title='Top 20 Causes for Accidents',
           x='',
           y='Normailized Counts') +
      theme_minimal() 
```





```{r message=FALSE, warning=FALSE}
    # use top 20 causes to filter original table with borough column:
    df_top <- df_cause_top%>%
      arrange(count)

    df <- df_cause%>%
      filter(!is.na(cause))%>%
      # use top 20 overall result to filter the original table:
      semi_join(., df_top, by='cause') %>%
      group_by(BOROUGH, cause) %>%
      summarise(count=n()) %>%
      mutate(cause = factor(cause, levels=df_top$cause))

    df_boro_tot <- df %>%
      group_by(BOROUGH) %>%
      summarise(total = sum(count))

      # calculate ratio for percentage axis display:
    df <- df %>%
      left_join(., df_boro_tot, by='BOROUGH') %>%
      mutate(ratio = format(round(count / total, 1), nsmall = 3)) %>%
      select( -total)

 theme_dotplot <- theme_bw(14) +
    theme(axis.text.y = element_text(size = rel(.75)),
        axis.ticks.y = element_blank(),
        axis.title.x = element_text(size = rel(.75)),
        panel.grid.major.x = element_blank(),
        panel.grid.major.y = element_line(size = 0.5),
        panel.grid.minor.x = element_blank())


 ggplot(df,
       aes(count, fct_reorder2(cause, BOROUGH, count,  .desc = FALSE),
           color = BOROUGH)) +
  geom_point() +
  theme_dotplot+
      labs(title='Borough-wise Causes for Accidents',
           y='',
           x='Count') + theme_minimal() + scale_fill_brewer(palette = "Set2")
```





```{r message=FALSE, warning=FALSE}
df_vehicle <- data_subset %>%
      select(BOROUGH, `VEHICLE TYPE CODE 1`, `VEHICLE TYPE CODE 2`, `VEHICLE TYPE CODE 3`, `VEHICLE TYPE CODE 4`, `VEHICLE TYPE CODE 5`) %>%
      gather(., key='key', value='vehicle',
             `VEHICLE TYPE CODE 1`, `VEHICLE TYPE CODE 2`, `VEHICLE TYPE CODE 3`, `VEHICLE TYPE CODE 4`, `VEHICLE TYPE CODE 5`) %>%
      mutate(vehicle = tolower(vehicle)) %>%
      mutate(vehicle = ifelse(vehicle == 'uliti', 'utili',         vehicle)) %>%
      mutate(vehicle = ifelse(vehicle == 'pk',    'pick-up truck', vehicle)) %>%
      mutate(vehicle = ifelse(vehicle == 'am',    'ambulance',     vehicle)) %>%
      mutate(vehicle = ifelse(vehicle == 'ambul', 'ambulance',     vehicle)) %>%
      mutate(vehicle = ifelse(vehicle == 'vn',    'van',           vehicle)) %>%
      mutate(vehicle = ifelse(vehicle == 'bu',    'bus',           vehicle)) %>%
      # filter out missing and most common, general, uninformative records:
      filter(! (vehicle %in% c('n/a', '',
                               'unknown','unkno','unk', 'other',
                               'passenger vehicle', 'sport utility / station wagon')))

  df_vehicle_top <- df_vehicle %>%
      filter(!is.na(vehicle))%>%
      group_by(vehicle) %>%
      summarise(count=n()) %>%
      top_n(20, count)


df_top <- df_vehicle_top%>%
      mutate(vehicle_z = round((count - min(count))/(max(count)-min(count)), 4),
             vehicle_type = ifelse(vehicle_z < 0, 'below', 'above')) %>%
      mutate(vehicle = tools::toTitleCase(vehicle))

    ggplot(data = df_top) +
      geom_bar(aes(x=reorder(vehicle, vehicle_z), y=vehicle_z,
                   fill=vehicle_type),
               width=0.5, stat='identity', show.legend = F, color="black", fill="orange") +
      coord_flip() +
      labs(title='Accidents by Type of Vehicles Involved',
           x='Type of Vehicle',
           y='Normalized Count')+
      theme_minimal()
```







Let's see the most accident-prone places in terms of no. of Accidents. Since, the data specifies that the police officer usually notes down the closest intersection of street and avenue, it would be logical to find out the  most accident-prone places based on these parameters, and I think this is the best approximation that we can get given the data.

I'm first going to find out the 25 most accident-prone Intersections.
```{r message=FALSE, warning=FALSE}
dangerous_places <- data_subset %>%
  filter(!is.na(`CROSS STREET NAME`) & !is.na(`ON STREET NAME`)) %>%
  group_by(LATITUDE,LONGITUDE, place = paste(`ON STREET NAME`,`CROSS STREET NAME`))%>%
  summarize(count = n())%>%
  arrange(desc(count))%>%
  head(25)

dangerous_places$Rank <- order(dangerous_places$count, decreasing = T)

dangerous_places$label <- paste(dangerous_places$Rank, dangerous_places$place, sep=". ")
```


I'm going to try and mark these places on the map, ordered in the format (`Rank`. `Cross Street Name`).

```{r message=FALSE, warning=FALSE}

temp = data_sample%>%
  select(LATITUDE,LONGITUDE,BOROUGH)

zoomed_p =  ggmap(get_googlemap(center = c(Longitude= -73.995249, Latitude = 40.734211),
                    zoom = 12, scale = 2,
                    maptype ='terrain',
                    color = 'color'))
zoomed_p + #geom_point(aes(x = LONGITUDE, y = LATITUDE), data = temp, alpha=0.2, size = 0.3) +
  geom_point(aes(x = LONGITUDE, y = LATITUDE, stroke = 2), colour="red", data = dangerous_places, size =1) +
  geom_label_repel(
    aes(LONGITUDE, LATITUDE, label = label),
    data=dangerous_places,
    family = 'Times',
    size = 3,
    box.padding = 0.2, point.padding = 0.5,
    segment.color = 'grey50') +
    xlab("Longitude")+
    ylab("Latitude")+
    ggtitle("25 Most Accident-Prone Cross-streets")+
  theme_minimal()
```

Straight off the bat, its clearly visible that Staten Island has no cross-street within the 25 most accident-prone intersections. Another interesting observation is that clusters are seen in this graph, especially in Manhattan, wherein very specific regions have such a high no. of accidents reported. Surprisingly, 2nd Avenue appears 5 times in this top 25 list, and particularly in a two specifically clustered regions, once in the (34th St. and 36th St. Cluster) and once in the (57th St and 59th St. Cluster). Also, Flatbush Avenue shows a similar trend, having a cluster of intersections that appear twice in the top 10. These are far too interesting observations to not dig deeper into, so I'm going to do exactly that, and hopefully find out the reason for this.

I'm going to zoom in on the clusters in Manhattan, specifically on the four intersections i.e. 2nd and 3rd Avenue across 57-59th streets.

```{r message=FALSE, warning=FALSE}
zoomed_p =  ggmap(get_googlemap(center = c(Longitude= -73.9675069, Latitude = 40.7601883),
                    zoom = 15, scale = 2,
                    maptype ='terrain',
                    color = 'color'))
zoomed_p +# geom_point(aes(x = LONGITUDE, y = LATITUDE, colour = BOROUGH), data = temp, alpha=0.2, size = 0.3) +
  geom_point(aes(x = LONGITUDE, y = LATITUDE, stroke = 2), colour="red", data = dangerous_places, size =1) +
  geom_label_repel(
    aes(LONGITUDE, LATITUDE, label = label),
    data=dangerous_places,
    family = 'Times',
    size = 3,
    box.padding = 0.2, point.padding = 0.5,
    segment.color = 'grey50') +
    xlab("Longitude")+
    ylab("Latitude")+
    ggtitle("Investigating Cluster of Accident-Prone Intersections in Manhattan (Mid-Town)")+
    theme_minimal()

```

Let's see what else we can find out about these 4 intersections.
```{r message=FALSE, warning=FALSE}
dangerous_places_combined <- merge(x = dangerous_places, y = data_subset, by=c("LATITUDE", "LONGITUDE"), all.x=TRUE)
```



***********************************************************************************
***********************************************************************************
***********************************************************************************
***********************************************************************************
***********************************************************************************

```{r message=FALSE, warning=FALSE}
intersection_ranks = c(2,4,5,12)
  dangerous_places_combined %>%
  filter(Rank %in% intersection_ranks) %>%
  group_by(Rank, place, YEAR)%>%
  summarize(`Pedestrian Injuries` = sum(`NUMBER OF PEDESTRIANS INJURED`), `Cyclist Injuries` = sum(`NUMBER OF CYCLIST INJURED`), `Motorist Injuries` = sum(`NUMBER OF MOTORIST INJURED`))%>%
  ungroup()%>%
  gather(`Injured People`,value,-place,-Rank, -YEAR) %>%
    mutate(place = fct_reorder(place, value, .desc = TRUE)) %>%
  ggplot( aes(x=place, y = value, fill=`Injured People` )) +
  geom_bar(stat = "identity", position='dodge', width=0.9)+
  xlab("Intersection")+
    coord_flip()+
    facet_wrap(.~YEAR)+
    ylab("Counts of Injuries")+
    ggtitle("Injuries at the Cluster Under Investigation from 2012-2019")

```


```{r message=FALSE, warning=FALSE}
intersection_ranks = c(2,4,5,12)
  dangerous_places_combined %>%
  filter(Rank %in% intersection_ranks) %>%
  group_by(Rank, place, YEAR)%>%
  summarize(`Pedestrian Killed` = sum(`NUMBER OF PEDESTRIANS KILLED`), `Cyclist Killed` = sum(`NUMBER OF CYCLIST KILLED`), `Motorist Killed` = sum(`NUMBER OF MOTORIST KILLED`))%>%
  ungroup()%>%
  gather(`Killed People`,value,-place,-Rank, -YEAR) %>%
    mutate(place = fct_reorder(place, value, .desc = TRUE)) %>%
  ggplot( aes(x=place, y = value, fill=`Killed People` )) +
  geom_bar(stat = "identity", position='dodge', width=0.9)+
  xlab("Intersection")+
    coord_flip()+
    ylab("Counts of Deaths")+
    ggtitle("Deaths at the Cluster Under Investigation from 2012-2019") +
    scale_y_continuous(limits = c(0,5))
```
